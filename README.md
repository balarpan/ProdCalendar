# Производственный Календарь

## Описание

Производственный календарь РФ. Основан на использовании сервисов проекта http://xmlcalendar.ru/
Содержит встроенные функции кеширования загружаемых календарей и повторного выкачивания апдейта при заданном периоде "устаревания" локальной копии.


## Пример использования

```python
from ProdCalendar import ProdCalendar
from datetime import date, time, timedelta, datetime

workCalendar = ProdCalendar(cache_dir='.cache/', cacheTTL=timedelta(days=14))
dt = datetime(2025, 12, 31)
workCalendar.isWorkDay(dt)  # -> False
workCalendar.isHoliday(dt)  # -> True

customCalendar = ProdCalendar(cache_dir='.cache/', overrideDates={datetime(2025, 12, 31): 0})
customCalendar.isWorkDay(datetime(2025, 12, 31))  # -> True
True
```


## Функциональность

- Поддержка только производственного календаря РФ.
- Проверка любой переданной даты на статус рабочего или нерабочего дня.
- Поддержка кеширования загруженных календарей.
- Поддержка переназначения статуса отдельных дат (рабочий или нерабочий день).


## Инициализация

При иницииализации класса **ProdCalendar** используются следующие параметры:

- cache (bool): включить кеширование (default: ```True```)
- cache_dir (str): каталог для файлов кеша (default: '.cache/')
- preload_year (int): предзагрузка указанного года (default: ```date.today().year```)
- cacheTTL (datetime.timedelta): время жизни кешированных данных
- overrideDates (dict[datetime.date, int]): переназначение отдельных дат. Необходимо передать массив в котором ключом
  является дата (```datetime.date```), а значением ```int``` (0 - рабочий день, 1 - выходной)


## Обработка исключений

**ProdCalendar** при использовании может бросать следующие два типа собственных исключений:

1. **ProdCalServiceNotRespond** - Exception для случаев ошибки загрузки данных календаря (сервис недоступен, ошибка сети и др.).
2. **ProdCalError** - для всех остальных нештатных случаев.


## Примечания

Один экземпляр класса **ProdCalendar** позволяет проверить любые произвольные даты, в том числе из разных календарных годов.
Календарь по мере необходимости отдельно для каждого календарного года.
Каждый загржуенный календарь в кеше хранится в виде отдельного файла, отдельно валидируется при проверке даты и при необходимости выкачивается повторно,
согласно заданному общему значению TTL.

Производственный календарь на год формируется заранее и случай внесения в него изменений после официальной публикации
крайне маловероятен, но возможен. В этом случае имеет смысл поставить период TTL календаря в кеше не слишком большой.

Для случаев работы с датами из прошедшего года изменений быть не может, а значит и механизм устаревания кеша не имеет практического смысла.
Для таких случаев целесообразно задавать чрезвычайно большие значения TTL, для избежания повторного выкачивания календаря за прошедший год.


Copyright ©2025
